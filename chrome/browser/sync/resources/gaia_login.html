<html i18n-values="dir:textdirection;">
<style type="text/css"><!--
  body,td,div,p,a,font,span {font-family: arial,sans-serif;}
  body { bgcolor:"#ffffff" } 
  A:link {color:#0000cc; } 
  A:visited { color:#551a8b; }
  A:active { color:#ff0000; }
  .form-noindent {background-color: #ffffff; border: #C3D9FF 1px solid}
--></style> 
  <head> 
    <style type="text/css"><!--
      .body { margin-left: 3em;
              margin-right: 5em;
              font-family: arial,sans-serif; }
      .endaligned {
        text-align: right;
      }
      html[dir='rtl'] .endaligned {
        text-align: left;
      }
      #gaia_account_text { font-weight: bold; }
      div.errorbox-good {}
      div.errorbox-bad {} 
      div.errormsg { color: red; font-size: smaller;
                     font-family: arial,sans-serif;
                     display: none;}
      font.errormsg { color: red; font-size: smaller;
                      font-family: arial,sans-serif;}
      hr {
        border: 0;
        background-color:#DDDDDD; 
        height: 1px;
        width: 100%;
        text-align: left;
        margin: 5px;
      }
      #gaia_loginform {
        margin-bottom: 0.5em;
      }
    --></style> 
  </head> 
  <body bgcolor="#ffffff" vlink="#666666"
        i18n-values=".style.fontFamily:fontfamily;.style.fontSize:fontsize"
        style="margin-bottom: 0" onload="initForm();"> 
  <table width="100%" align="center" cellpadding="1" cellspacing="1"> 
  <tr> 
  <td valign="top"> <!-- LOGIN BOX --> 
  <script>  
    function gaia_setFocus() {
      var f = null;
      if (document.getElementById) { 
        f = document.getElementById("gaia_loginform");
      } else if (window.gaia_loginform) { 
        f = window.gaia_loginform;
      } 
      if (f) {
        if (f.Email && (f.Email.value == null || f.Email.value == "")) {
          f.Email.focus();
        } else if (f.Passwd) {
          f.Passwd.focus();
        } 
      }
    }
 
    function advanceThrobber() {
      var throbber = document.getElementById('throb');
      throbber.style.backgroundPositionX =
      ((parseInt(throbber.style.backgroundPositionX) - 16) % 576) + 'px';
    }
 
    function showGaiaLogin(args) {
      var throbber = document.getElementById('throbber_container');
      throbber.style.display = "none";
      var f = document.getElementById("gaia_loginform");
      if (f) {        
        f.Email.value = args.user; 
      }     
      if (1 == args.error) {
        setElementDisplay("errormsg_1_Password", 'table-row');
        setBlurbError();
      }
      if (3 == args.error) {
        setElementDisplay("errormsg_0_Connection", 'table-row');
        setBlurbError();
      }
      document.getElementById("signIn").disabled = false;
      gaia_setFocus();
    }
    
    function CloseDialog() {
      chrome.send("DialogClose", [""]);
    }
    
    function showGaiaSuccessAndClose() {
      document.getElementById("signIn").value = templateData['success'];
      setTimeout(CloseDialog, 1600);
    }
    
    function showGaiaSuccessAndSettingUp() {
      document.getElementById("signIn").value = templateData['settingup'];
    }

    function initForm() {
      var acct_text = document.getElementById("gaia_account_text");
      var translated_text = acct_text.textContent;
      var posGoogle = translated_text.indexOf('Google');
      if (posGoogle != -1) {
        var ltr = templateData['textdirection'] == 'ltr';
        var googleIsAtEndOfSentence = posGoogle != 0;
        if (googleIsAtEndOfSentence == ltr) {
          // We're in ltr and in the translation the word 'Google' is AFTER the
          // word 'Account' OR we're in rtl and 'Google' is BEFORE 'Account'.
          var logo_td = document.getElementById('gaia_logo');
          logo_td.parentNode.appendChild(logo_td);
        }
        acct_text.textContent = translated_text.replace('Google','');
      }
      setInterval(advanceThrobber, 30);
      var args = JSON.parse(chrome.dialogArguments);
      showGaiaLogin(args);
    }

    function sendCredentialsAndClose() {
      if (!setErrorVisibility())
        return false;
        
      var throbber = document.getElementById('throbber_container');
      throbber.style.display = "inline";
      var f = document.getElementById("gaia_loginform");
      var result = JSON.stringify({"user" : f.Email.value,
                                   "pass" : f.Passwd.value});
      document.getElementById("signIn").disabled = true;
      chrome.send("SubmitAuth", [result]);
    }
        
    function setElementDisplay(id, display) {
      var d = document.getElementById(id);
      if (d)
        d.style.display = display;
    }    
    
    function setBlurbError() {
      document.getElementById("top_blurb").style.display = "none";
      document.getElementById("top_blurb_error").style.display = "block";
    }
    
    function resetErrorVisibility() {
      setElementDisplay("errormsg_0_Email", 'none');
      setElementDisplay("errormsg_0_Password", 'none');
      setElementDisplay("errormsg_1_Password", 'none');
      setElementDisplay("errormsg_0_Connection", 'none');
    }   
    
    function setErrorVisibility() {
      resetErrorVisibility();
      var f = document.getElementById("gaia_loginform");      
      if (null == f.Email.value || "" == f.Email.value) {
        setElementDisplay("errormsg_0_Email", 'table-row');
        setBlurbError();
        return false;
      }      
      if (null == f.Passwd.value || "" == f.Passwd.value) {
        setElementDisplay("errormsg_0_Password", 'table-row');
        setBlurbError();
        return false;
      }
      return true;
    }
  </script> 
<style type="text/css"><!--
  div.errormsg { color: red; font-size: smaller; font-family:arial,sans-serif; }
  font.errormsg { color: red; font-size: smaller; font-family:arial,sans-serif;}  
--></style> 
<style type="text/css"><!--
.gaia.le.lbl { font-family: Arial, Helvetica, sans-serif; font-size: smaller; }
.gaia.le.fpwd { font-family: Arial, Helvetica, sans-serif; font-size: 70%; }
.gaia.le.chusr { font-family: Arial, Helvetica, sans-serif; font-size: 70%; }
.gaia.le.val { font-family: Arial, Helvetica, sans-serif; font-size: smaller; }
.gaia.le.button { font-family: Arial, Helvetica, sans-serif; font-size: smaller; }
.gaia.le.rem { font-family: Arial, Helvetica, sans-serif; font-size: smaller; }
.gaia.captchahtml.desc { font-family: arial, sans-serif; font-size: smaller; } 
.gaia.captchahtml.cmt { font-family: arial, sans-serif; font-size: smaller;
                        font-style: italic; }
--></style> 
<div id="top_blurb">
  <p><font size="-1"><span i18n-content="introduction"></span></font></p>
</div>
<div id="top_blurb_error" style="display:none">
  <p><font size="-1">
    <span i18n-content="settingupsync"></span><br/><br/>
    <b><span i18n-content="errorsigningin"></span></b>
  </font></p>
</div>
<form id="gaia_loginform" onsubmit="sendCredentialsAndClose(); return false;"> 
<div id="gaia_loginbox"> 
<table class="form-noindent" cellspacing="3" cellpadding="5" width="75%"
       border="0" align="center"> 
  <tr> 
    <td valign="top" style="text-align:center" nowrap="nowrap"
        bgcolor="#e8eefa"> 
      <div class="loginBox"> 
        <table id="gaia_table" align="center" border="0" cellpadding="1"
               cellspacing="0"> 
          <tr> 
            <td colspan="2" align="center"> 
              <font size="-1"><span i18n-content="signinprefix"></span></font> 
              <table> 
                <tr> 
                  <td valign="top" id="gaia_logo">
                    <img src="google_transparent.png" alt="Google">
                    </img> 
                  </td>  
                  <td valign="middle"> 
                    <font size="+0">
                      <span id="gaia_account_text" i18n-content="signinsuffix"></span>
                    </font> 
                  </td> 
                </tr> 
              </table> 
            </td> 
          </tr> 
          <script type="text/javascript"><!--
            function onPreCreateAccount() {
              return true;
            }
            function onPreLogin() {
              if (window["onlogin"] != null) {
                return onlogin(); 
              } else {
                return true;
              }
            }
          --></script> 
          <tr> 
            <td colspan="2" align="center"> </td> 
          </tr>
          <tr>
            <td nowrap="nowrap">
              <div class="endaligned">
                <span class="gaia le lbl" i18n-content="emaillabel">
                </span> 
              </div> 
            </td> 
            <td> 
              <input type="text" name="Email"  id="Email" size="18"
                     value="" class='gaia le val' /> 
            </td> 
          </tr>
          <tr> 
            <td></td> 
            <td>
              <div class="errormsg" id="errormsg_0_Email"
                   i18n-content="cannotbeblank">
              </div> 
            </td> 
          </tr>           
          <tr> 
            <td></td>
            <td></td>
          </tr>
          <tr>
            <td class="endaligned">
              <span class="gaia le lbl" i18n-content="passwordlabel">
              </span> 
            </td> 
            <td> 
              <input type="password" name="Passwd" id="Passwd" size="18"
                     class="gaia le val"/> 
            </td> 
          </tr>
          <tr> 
            <td></td> 
            <td>
              <div class="errormsg" id="errormsg_0_Password"
                   i18n-content="cannotbeblank">
              </div> 
            </td> 
          </tr>
          <tr> 
            <td> 
            </td> 
            <td>
              <div class="errormsg" id="errormsg_1_Password">
              <span i18n-content="invalidcredentials"></span>[<a href="http://www.google.com/support/accounts/bin/answer.py?ctx=ch&answer=27444">?</a>]
              </div> 
            </td> 
          </tr> 
          <tr>
            <td>
            </td>
            <td>
              <div class="errormsg" id="errormsg_0_Connection"
                   i18n-content="couldnotconnect">
              </div> 
            </td> 
          </tr>          
          <tr> 
            <td> 
            </td>
            <td>
            </td>
          </tr> 
          <tr> 
            <td> 
            </td> 
            <td>
              <table>
                <tr>
                  <td>
                    <div id="throbber_container" style="display:none">
                      <div id="throb" style="background-image:url(throbber.png);
                           width:16px; height:16px; background-position:0px;">
                      </div>
                    </div>
                  </td>
                  <td>
                    <input id="signIn" type="button" class="gaia le button"
                           name="signIn" i18n-values="value:signin"
                           onclick="sendCredentialsAndClose();"
                           style="width:85" />
                  </td>
                </tr>
              </table>
            </td> 
          </tr>
          <tr id="ga-fprow"> 
            <td colspan="2" height="16.0" class="gaia le fpwd"
                align="center" valign="bottom"> 
              <a href="http://www.google.com/support/accounts/bin/answer.py?answer=48598&hl=en&fpUrl=https%3A%2F%2Fwww.google.com%2Faccounts%2FForgotPasswd%3FfpOnly%3D1%26service%3Dchromiumsync"
                 target=_blank i18n-content="cannotaccessaccount">
              </a> 
            </td>
          </tr> 
          <tr>
            <td colspan="2" height="16.0" class="gaia le fpwd"
                align="center" valign="bottom"> 
              <a href="javascript:var popup=window.open('https%3A%5Cx2F%5Cx2Fwww.google.com%5Cx2Faccounts%5Cx2FNewAccount%3Fservice%3Dchromiumsync', 'NewAccount', 'height=870,width=870,resizable=yes,scrollbars=yes');"
                 i18n-content="createaccount">
              </a> 
           </td> 
          </tr>
        </table> 
      </div> 
    </td> 
  </tr> 
</table> 
</div> 
</form> 
</td> 
</tr> 
</table> 
<div class="endaligned">
  <input type="button" name="cancel" i18n-values="value:cancel"
         onclick="CloseDialog();" style="width:85" />
</div>
</body> 
</html>
