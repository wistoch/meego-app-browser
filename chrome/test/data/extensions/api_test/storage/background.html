<script>
  // store some stuff in local storage
  localStorage.foo = "bar";

  // store some stuff in a database
  var db = window.openDatabase("mydb2", "1.0", "database test", 2048);
  if (!db)
    chrome.test.fail("failed to open database");

  db.transaction(function(tx) {
    tx.executeSql("drop table if exists note", [], null, onSqlError);
    tx.executeSql("create table note (body text)", [], null, onSqlError);
    tx.executeSql("insert into note values ('hotdog')", [], onSqlExecuted,
                  onSqlError);
  }, function(error) {
    chrome.test.fail(error.message);
  });

  function onSqlError(tx, error) {
    chrome.test.fail(error.message);
  }
  function onSqlExecuted() {
    // Open a tab. This doesn't really prove we're writing to disk, but it is
    // difficult to prove that without shutting down the process. We'll just
    // trust that if this next trick works, that the real testing for local
    // storage is good enough to catch more subtle errors.
    chrome.tabs.create({
      url: "tab.html"
    });
  }
</script>
