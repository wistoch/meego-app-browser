#!/bin/sh

# Copyright (c) 2009 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

# This script creates sign.sh, the script that will be used to sign the
# application bundle and inner bundles.  sign.sh is placed in the Packaging
# directory next to the .app bundle.  The packaging system is expected to run
# sign.sh to sign everything.

set -e

if [ $# -ne 2 ] ; then
  echo "usage: ${0} PACKAGING_DIR MAC_PRODUCT_NAME" >& 2
  exit 1
fi

PACKAGING_DIR="${1}"
MAC_PRODUCT_NAME="${2}"
SIGN_SH_IN_FILE="$(dirname "${0}")/sign.sh.in"
SIGN_SH_FILE="${PACKAGING_DIR}/sign.sh"

mkdir -p "${PACKAGING_DIR}"
sed -e "s/@MAC_PRODUCT_NAME@/${MAC_PRODUCT_NAME}/g" \
    < "${SIGN_SH_IN_FILE}" \
    > "${SIGN_SH_FILE}"
chmod a+rx "${SIGN_SH_FILE}"
