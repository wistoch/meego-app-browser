<body>

<script type="text/javascript">

var id_string_dictionary = new Object;
var last_id = 0;

function SendString() {
  plugin = document.getElementById('plugin');

  // If we haven't already done it, set up an 'onmessage' function.  This will
  // get invoked whenever the plugin calls Instance::PostMessage in C++ (or
  // PPB_Instance::PostMessage in C).  In this case, we're expecting a bool to
  // tell us whether the string we passed was a palindrome.
  if (!plugin.onmessage) {
    plugin.onmessage = function(message_event) {
      var id_bool_pair = message_event.data.split(",");
      var sent_string = id_string_dictionary[id_bool_pair[0]];
      delete id_string_dictionary[id_bool_pair[0]];
      if (id_bool_pair[1] == "true") {
        alert(sent_string + " was a palindrome.");
      } else {
        alert(sent_string + " was not a palindrome.");
      }
    }
  }

  var inputBox = document.getElementById("inputBox");

  // Send an id and a string to the plugin using postMessage.  This results in a call
  // to Instance::HandleMessage in C++ (or PPP_Instance::HandleMessage in C).
  var id = ++last_id;

  plugin.postMessage(id + "," + inputBox.value);
  // Now put the string in our dictionary, so when we get a response, we know
  // which request it goes with.
  id_string_dictionary[id] = inputBox.value;
}

</script>

<input type="text" id="inputBox" name="inputBox" value="ablewasiereisawelba"/>
<p>
<button onclick='SendString()'>Is Palindrome</button>
<object id="plugin" type="application/x-ppapi-reentrant-example"
        width="0" height="0"/>
<hr>
</body>
