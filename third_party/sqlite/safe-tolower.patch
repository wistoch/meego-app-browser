diff --git a/third_party/sqlite/src/ext/fts1/fts1.c b/third_party/sqlite/src/ext/fts1/fts1.c
index 8ae8df4..d5d00b9 100644
--- a/third_party/sqlite/src/ext/fts1/fts1.c
+++ b/third_party/sqlite/src/ext/fts1/fts1.c
@@ -208,7 +208,7 @@ static int safe_isspace(char c){
   return (c&0x80)==0 ? isspace(c) : 0;
 }
 static int safe_tolower(char c){
-  return (c&0x80)==0 ? tolower(c) : c;
+  return (c>='A' && c<='Z') ? (c-'A'+'a') : c;
 }
 static int safe_isalnum(char c){
   return (c&0x80)==0 ? isalnum(c) : 0;
diff --git a/third_party/sqlite/src/ext/fts1/fts1_tokenizer1.c b/third_party/sqlite/src/ext/fts1/fts1_tokenizer1.c
index f58fba8..90774da 100644
--- a/third_party/sqlite/src/ext/fts1/fts1_tokenizer1.c
+++ b/third_party/sqlite/src/ext/fts1/fts1_tokenizer1.c
@@ -182,7 +182,7 @@ static int simpleNext(
         ** case-insensitivity.
         */
         unsigned char ch = p[iStartOffset+i];
-        c->pToken[i] = ch<0x80 ? tolower(ch) : ch;
+        c->pToken[i] = (ch>='A' && ch<='Z') ? (ch-'A'+'a') : ch;
       }
       *ppToken = c->pToken;
       *pnBytes = n;
diff --git a/third_party/sqlite/src/ext/fts1/simple_tokenizer.c b/third_party/sqlite/src/ext/fts1/simple_tokenizer.c
index d00a770..9a52bd1 100644
--- a/third_party/sqlite/src/ext/fts1/simple_tokenizer.c
+++ b/third_party/sqlite/src/ext/fts1/simple_tokenizer.c
@@ -138,7 +138,7 @@ static int simpleNext(
         ** case-insensitivity.
         */
         char ch = c->pCurrent[ii];
-        c->zToken[ii] = (unsigned char)ch<0x80 ? tolower(ch) : ch;
+        c->zToken[ii] = ((ch>='A' && ch<='Z') ? (ch-'A'+'a') : ch);
       }
       c->zToken[n] = '\0';
       *ppToken = c->zToken;
