# Copyright (c) 2006-2008 The Chromium Authors. All rights reserved.
# Use of this source code is governed by a BSD-style license that can be
# found in the LICENSE file.

Import('env')

env = env.Clone()


if env['PLATFORM'] == 'posix':
    # TODO(erg): adding to the badness.
    env.Command("WebCore/v8/config.h",
                ["create-config.sh", "../../config.h.in"],
                "cd ${SOURCE.dir} && /bin/bash -x ${SOURCE.file} ${JSCONFIG_DIR.abspath} v8",
                JSCONFIG_DIR = env.Dir('$WEBKIT_DIR/build/JSConfig'))               
else:
    # TODO(bradnelson): very bad, calls batch, calls sh, deps all wrong
    env.Append(ENV = {"OS" : "Windows_NT"})
    env.Command("obj/WebCore/config.h",
                ["prebuild.bat", "../../config.h.in"],
                "cd ${SOURCE.dir} && ${SOURCE.file} ${JSCONFIG_DIR.abspath} v8",
                JSCONFIG_DIR = env.Dir('$WEBKIT_DIR/build/JSConfig'))

